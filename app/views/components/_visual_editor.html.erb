<%
  id ||= "#{name}-#{SecureRandom.hex(4)}"
  label_id = "#{id}-label"
  value ||= nil
  ga4_tracking_section ||= nil
  error_items ||= nil

  error_class = "govuk-form-group--error" if error_items
%>

<%= tag.div class: error_class, "data-module": "visual-editor" do %>
  <div class="app-c-visual-editor__govspeak-editor-wrapper">
    <%= render "components/govspeak_editor", {
      label:,
      name:,
      id:,
      value:,
      rows:,
      error_items:,
      right_to_left:,
      data_attributes:,
    } %>
  </div>

  <div class="app-c-visual-editor__visual-editor-wrapper">
    <%= render "govuk_publishing_components/components/label", {
        id: label_id,
        html_for: id,
      }.merge(label.symbolize_keys) %>
    <div class="js-app-c-visual-editor__inset-text">
    <%= render "govuk_publishing_components/components/inset_text", {
    } do %>
      <p class="govuk-body"><%= I18n.t("admin.visual_editor.exit.description").html_safe %></p>
      <%= render "govuk_publishing_components/components/button", {
        text: I18n.t("admin.visual_editor.exit.button"),
        secondary_solid: true,
        type: "button",
        classes: "js-app-c-visual-editor__exit-button",
        destructive: true,
        data_attributes: {
          "ga4-event": {
            event_name: "visual_editor_exit",
            type: "tabs",
            text: I18n.t("admin.visual_editor.exit.button"),
            section: ga4_tracking_section,
            action: I18n.t("admin.visual_editor.exit.button"),
            tool_name: "Visual Editor",
          }.to_json,
        },
      } %>
    <% end %>
    </div>

    <div class="app-c-visual-editor__content">
      <%= govspeak_to_admin_html value, [], [], nil %>
    </div>

    <div class="app-c-visual-editor__container"></div>
  </div>

  <%= hidden_field_tag hidden_field_name, false, {class: "app-c-visual-editor__hidden-field"} %>
<% end %>

<%= javascript_include_tag "components/visual-editor", :type => "module" %>
